# -------------------------------------------------------------
# StitchTracker Environment Template
# Copy this to .env.test or .env.public depending on your use.
# -------------------------------------------------------------

# -------------------------------------------------------------
# Django settings
# -------------------------------------------------------------
DJANGO_SETTINGS_MODULE=stitchtracker_backend.settings.prod
SECRET_KEY=replace-me-with-a-long-random-string
DEBUG=0                     # 1 for dev/testing, 0 for production
ENABLE_HTTPS=0              # Set to 1 only if serving via HTTPS (real TLS)

# Base URL where StitchTracker is served (used in various redirects)
# For the default docker-compose (reverse-proxy on port 8082):
SITE_URL=http://localhost:8082

# -------------------------------------------------------------
# Allowed hosts and CSRF origins
# Adjust these to match your LAN IP or hostname
# -------------------------------------------------------------
ALLOWED_HOSTS=*,localhost,127.0.0.1
CSRF_TRUSTED_ORIGINS=http://localhost:8082,http://127.0.0.1:8082

# Examples if you access from another device on your LAN:
# ALLOWED_HOSTS=*,localhost,127.0.0.1,192.168.1.100
# CSRF_TRUSTED_ORIGINS=http://localhost:8082,http://127.0.0.1:8082,http://192.168.1.100:8082

# -------------------------------------------------------------
# Database configuration (Postgres)
# -------------------------------------------------------------
DB_NAME=stitchtracker_public
DB_USER=stitch
DB_PASSWORD=publicpw
DB_HOST=db
DB_PORT=5432

# These initialize the Postgres container on first boot.
# Keep them identical to the DB_* values above.
POSTGRES_DB=stitchtracker_public
POSTGRES_USER=stitch
POSTGRES_PASSWORD=publicpw

# -------------------------------------------------------------
# Optional email settings (uncomment and configure as needed)
# -------------------------------------------------------------
# EMAIL_HOST=smtp.example.com
# EMAIL_PORT=587
# EMAIL_USE_TLS=1
# EMAIL_HOST_USER=username
# EMAIL_HOST_PASSWORD=password

# -------------------------------------------------------------
# Optional OpenID Connect (OIDC) / Single Sign-On
# -------------------------------------------------------------
# By default OIDC is disabled (you can still use local username/password).
# Set ENABLE_OIDC=1 and configure the values below to enable SSO.
ENABLE_OIDC=0

# Frontend URL that receives the tokens after OIDC login.
# In the default docker-compose setup, the frontend is also served on SITE_URL.
# StitchTracker will redirect to: FRONTEND_OIDC_REDIRECT_URL?access=...&refresh=...
FRONTEND_OIDC_REDIRECT_URL=http://localhost:8082/oidc-callback

# ---- If ENABLE_OIDC=1, set these to match your Identity Provider ----
# These are EXAMPLES. Replace idp.example.com and paths with your IdPs
# discovery document / documentation.

# Client credentials from your IdP (e.g. Keycloak, Authentik, PocketID, etc.)
# OIDC_RP_CLIENT_ID=my-stitchtracker-client-id
# OIDC_RP_CLIENT_SECRET=my-stitchtracker-client-secret

# Standard OIDC endpoints from your IdP:
# (Copy these from your IdPs .well-known/openid-configuration)
# OIDC_OP_AUTHORIZATION_ENDPOINT=https://idp.example.com/authorize
# OIDC_OP_TOKEN_ENDPOINT=https://idp.example.com/api/oidc/token
# OIDC_OP_USER_ENDPOINT=https://idp.example.com/api/oidc/userinfo
# OIDC_OP_JWKS_ENDPOINT=https://idp.example.com/.well-known/jwks.json

# Optional tweaks (these defaults are usually fine):
# OIDC_RP_SCOPES=openid email profile
# OIDC_RP_SIGN_ALGO=RS256
# OIDC_CREATE_USER=false   # If true, new Django users will be auto-created for unknown IdP users

# -------------------------------------------------------------
# Usage
# -------------------------------------------------------------
# For local dev/test (debug mode):
#   cp .env.example .env.test
#   (then edit SECRET_KEY, DEBUG, SITE_URL, etc. as needed)
#   docker compose up -d --build
#
# For stable homelab / production:
#   cp .env.example .env.public
#   Set DEBUG=0 and a real SECRET_KEY
#   Set SITE_URL and CSRF_TRUSTED_ORIGINS to your actual URL
#   Optionally enable OIDC by setting ENABLE_OIDC=1 and filling in OIDC_* vars
#   docker compose up -d --build
# -------------------------------------------------------------
